<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>My Birthday üéâ</title>

  <!-- Montserrat Font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;800&display=swap" rel="stylesheet">

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Montserrat', sans-serif; }
    body {
      min-height: 100vh;
      background:
        radial-gradient(1200px 800px at 20% 20%, rgba(106,90,205,0.3), transparent 60%),
        radial-gradient(1200px 800px at 80% 80%, rgba(0,201,255,0.3), transparent 60%),
        linear-gradient(135deg, #4b3ca0, #007acc);
      background-size: 200% 200%, 200% 200%, 100% 100%;
      animation: bgFloat 18s ease-in-out infinite;
      display: flex; align-items: center; justify-content: center; color: white; text-align: center;
    }
    @keyframes bgFloat { 0% { background-position: 10% 20%, 90% 80%, 0% 0%; } 50% { background-position: 30% 40%, 70% 60%, 0% 0%; } 100% { background-position: 10% 20%, 90% 80%, 0% 0%; } }

    .card { position: relative; width: 100vw; height: 100vh; background: rgba(0,0,0,0.55); padding: 4rem 2rem; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: inset 0 0 40px rgba(0,170,255,0.4), 0 0 60px rgba(0,170,255,0.6); border: 4px solid rgba(0,170,255,0.8); }
    h1 { font-size: 7vw; font-weight: 800; margin-bottom: 2vh; }
    h2 { font-size: 4vw; font-weight: 600; margin-bottom: 1.5vh; }
    p { font-size: 1.1rem; margin-top: 1rem; font-weight: 400; }

    .countdown { display: grid; grid-template-columns: repeat(4,1fr); gap: 2vw; margin-top: 4vh; width: 90vw; }
    .box { background: rgba(0,40,80,0.6); border-radius: 15px; padding: 1.2rem; box-shadow: 0 0 15px rgba(0,170,255,0.6),0 0 30px rgba(0,170,255,0.4); border: 2px solid rgba(0,170,255,0.8); }
    .number { font-size: 6vw; font-weight: 800; }
    .label { font-size: 1.8vw; opacity: 0.85; }
    .time { margin-top: 2vh; font-size: 3.5vw; font-weight: 600; }
    .emoji { font-size: 4vw; margin-top: 3vh; }
    footer { margin-top: 4vh; font-size: 3vw; opacity: 0.9; }

    #waitingCounter {
      position: absolute;
      top: 1rem;
      left: 1rem;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      background: rgba(0,0,0,0.6);
      border: 2px solid rgba(0,170,255,0.8);
      border-radius: 10px;
      color: white;
      z-index: 10;
    }
  </style>
</head>
<body>
  <div id="waitingCounter">Waiting: 1</div>
  <div class="card">
    <h1>üéÇ My Birthday üéÇ</h1>
    <h2>February 6th</h2>
    <div class="time">üï† 5:30 PM</div>

    <div class="countdown" id="countdown">
      <div class="box"><div class="number" id="days">0</div><div class="label">DAYS</div></div>
      <div class="box"><div class="number" id="hours">0</div><div class="label">HOURS</div></div>
      <div class="box"><div class="number" id="minutes">0</div><div class="label">MINUTES</div></div>
      <div class="box"><div class="number" id="seconds">0</div><div class="label">SECONDS</div></div>
    </div>

    <div class="emoji">üéâüéàüéÅ</div>
    <footer><p>Save the date üíú</p></footer>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js';
    import { getDatabase, ref, push, onValue, remove, set } from 'https://www.gstatic.com/firebasejs/9.22.2/firebase-database.js';

    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT_ID.firebaseio.com",
      projectId: "YOUR_PROJECT_ID",
      storageBucket: "YOUR_PROJECT_ID.appspot.com",
      messagingSenderId: "YOUR_SENDER_ID",
      appId: "YOUR_APP_ID"
    };

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);
    const counterRef = ref(db, 'waitingCounter');

    // Immediately set counter to 1 for this visitor
    const waitingEl = document.getElementById('waitingCounter');
    waitingEl.textContent = 'Waiting: 1';

    const myCounterRef = push(counterRef);
    set(myCounterRef, true);

    window.addEventListener('beforeunload', () => {
      remove(myCounterRef);
    });

    onValue(counterRef, (snapshot) => {
      const count = snapshot.size || 1; // always show at least 1 for first visitor
      waitingEl.textContent = `Waiting: ${count}`;
    });

    const birthday = new Date(new Date().getFullYear(), 1, 6, 17, 30, 0);
    if (birthday < new Date()) { birthday.setFullYear(birthday.getFullYear() + 1); }

    const daysEl = document.getElementById('days');
    const hoursEl = document.getElementById('hours');
    const minutesEl = document.getElementById('minutes');
    const secondsEl = document.getElementById('seconds');

    let confettiStarted = false;
    function launchConfetti() {
      if (confettiStarted) return;
      confettiStarted = true;
      const duration = 5000;
      const end = Date.now() + duration;
      (function frame() {
        confetti({ particleCount: 5, angle: 60, spread: 55, origin: { x: 0 } });
        confetti({ particleCount: 5, angle: 120, spread: 55, origin: { x: 1 } });
        if (Date.now() < end) requestAnimationFrame(frame);
      })();
    }

    function updateCountdown() {
      const now = new Date();
      const diff = birthday - now;
      if (diff <= 0) {
        daysEl.textContent = hoursEl.textContent = minutesEl.textContent = secondsEl.textContent = 0;
        launchConfetti();
        return;
      }
      daysEl.textContent = Math.floor(diff / (1000*60*60*24));
      hoursEl.textContent = Math.floor((diff / (1000*60*60)) % 24);
      minutesEl.textContent = Math.floor((diff / (1000*60)) % 60);
      secondsEl.textContent = Math.floor((diff / 1000) % 60);
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);
  </script>
</body>
</html>
